<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd">

    <changeSet id="1" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="pa_application_seq"/>
            </not>
        </preConditions>
        <comment>Create a new sequence pa_application_seq</comment>
        <createSequence sequenceName="pa_application_seq" startValue="1" incrementBy="1" cacheSize="20"/>
    </changeSet>

    <changeSet id="2" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="pa_application_version_seq"/>
            </not>
        </preConditions>
        <comment>Create a new sequence pa_application_version_seq</comment>
        <createSequence sequenceName="pa_application_version_seq" startValue="1" incrementBy="1" cacheSize="20"/>
    </changeSet>

    <changeSet id="3" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="pa_master_keypair_seq"/>
            </not>
        </preConditions>
        <comment>Create a new sequence pa_master_keypair_seq</comment>
        <createSequence sequenceName="pa_master_keypair_seq" startValue="1" incrementBy="1" cacheSize="20"/>
    </changeSet>

    <changeSet id="4" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="pa_signature_audit_seq"/>
            </not>
        </preConditions>
        <comment>Create a new sequence pa_signature_audit_seq</comment>
        <createSequence sequenceName="pa_signature_audit_seq" startValue="1" incrementBy="1" cacheSize="20"/>
    </changeSet>

    <changeSet id="5" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="pa_activation_history_seq"/>
            </not>
        </preConditions>
        <comment>Create a new sequence pa_activation_history_seq</comment>
        <createSequence sequenceName="pa_activation_history_seq" startValue="1" incrementBy="1" cacheSize="20"/>
    </changeSet>

    <changeSet id="6" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="pa_recovery_code_seq"/>
            </not>
        </preConditions>
        <comment>Create a new sequence pa_recovery_code_seq</comment>
        <createSequence sequenceName="pa_recovery_code_seq" startValue="1" incrementBy="1" cacheSize="20"/>
    </changeSet>

    <changeSet id="7" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="pa_recovery_puk_seq"/>
            </not>
        </preConditions>
        <comment>Create a new sequence pa_recovery_puk_seq</comment>
        <createSequence sequenceName="pa_recovery_puk_seq" startValue="1" incrementBy="1" cacheSize="20"/>
    </changeSet>

    <changeSet id="8" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="pa_recovery_config_seq"/>
            </not>
        </preConditions>
        <comment>Create a new sequence pa_recovery_config_seq</comment>
        <createSequence sequenceName="pa_recovery_config_seq" startValue="1" incrementBy="1" cacheSize="20"/>
    </changeSet>

    <changeSet id="9" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="pa_operation_template_seq"/>
            </not>
        </preConditions>
        <comment>Create a new sequence pa_operation_template_seq</comment>
        <createSequence sequenceName="pa_operation_template_seq" startValue="1" incrementBy="1" cacheSize="20"/>
    </changeSet>

    <changeSet id="10" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_application"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_application</comment>
        <createTable tableName="pa_application">
            <column name="id" type="integer">
                <constraints primaryKey="true" />
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="roles" type="varchar(255)" />
        </createTable>
    </changeSet>

    <changeSet id="11" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_master_keypair"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_master_keypair</comment>
        <createTable tableName="pa_master_keypair">
            <column name="id" type="integer">
                <constraints primaryKey="true" />
            </column>
            <column name="application_id" type="integer">
                <constraints nullable="false" foreignKeyName="keypair_application_fk" referencedTableName="pa_application" referencedColumnNames="id" />
            </column>
            <column name="master_key_private_base64" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="master_key_public_base64" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="name" type="varchar(255)" />
            <column name="timestamp_created" type="timestamp(6)">
                <constraints nullable="false" />
            </column>
        </createTable>
    </changeSet>

    <changeSet id="12" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_activation"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_activation</comment>
        <createTable tableName="pa_activation">
            <column name="activation_id" type="varchar(37)">
                <constraints primaryKey="true" />
            </column>
            <column name="application_id" type="integer">
                <constraints nullable="false" foreignKeyName="activation_application_fk" referencedTableName="pa_application" referencedColumnNames="id" />
            </column>
            <column name="user_id" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="activation_name" type="varchar(255)" />
            <column name="activation_code" type="varchar(255)" />
            <column name="activation_status" type="integer">
                <constraints nullable="false" />
            </column>
            <column name="activation_otp" type="varchar(255)" />
            <column name="activation_otp_validation" type="integer" defaultValue="0">
                <constraints nullable="false" />
            </column>
            <column name="blocked_reason" type="varchar(255)" />
            <column name="counter" type="integer">
                <constraints nullable="false" />
            </column>
            <column name="ctr_data" type="varchar(255)" />
            <column name="device_public_key_base64" type="varchar(255)" />
            <column name="extras" type="varchar(255)" />
            <column name="platform" type="varchar(255)" />
            <column name="device_info" type="varchar(255)" />
            <column name="flags" type="varchar(255)" />
            <column name="failed_attempts" type="integer">
                <constraints nullable="false" />
            </column>
            <column name="max_failed_attempts" type="integer" defaultValue="5">
                <constraints nullable="false" />
            </column>
            <column name="server_private_key_base64" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="server_private_key_encryption" type="integer" defaultValue="0">
                <constraints nullable="false" />
            </column>
            <column name="server_public_key_base64" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_activation_expire" type="timestamp(6)">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_created" type="timestamp(6)">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_last_used" type="timestamp(6)">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_last_change" type="timestamp(6)" />
            <column name="master_keypair_id" type="integer">
                <constraints foreignKeyName="activation_keypair_fk" referencedTableName="pa_master_keypair" referencedColumnNames="id" />
            </column>
            <column name="version" type="integer" defaultValue="2" />
        </createTable>
    </changeSet>

    <changeSet id="13" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_application_version"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_application_version</comment>
        <createTable tableName="pa_application_version">
            <column name="id" type="integer">
                <constraints primaryKey="true" />
            </column>
            <column name="application_id" type="integer">
                <constraints nullable="false" foreignKeyName="version_application_fk" referencedTableName="pa_application" referencedColumnNames="id" />
            </column>
            <column name="application_key" type="varchar(255)" />
            <column name="application_secret" type="varchar(255)" />
            <column name="name" type="varchar(255)" />
            <column name="supported" type="boolean" />
        </createTable>
    </changeSet>

    <changeSet id="14" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_signature_audit"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_signature_audit</comment>
        <createTable tableName="pa_signature_audit">
            <column name="id" type="bigint">
                <constraints primaryKey="true" />
            </column>
            <column name="activation_id" type="varchar(37)">
                <constraints nullable="false" foreignKeyName="audit_activation_fk" referencedTableName="pa_activation" referencedColumnNames="activation_id"/>
            </column>
            <column name="activation_counter" type="integer">
                <constraints nullable="false" />
            </column>
            <column name="activation_ctr_data" type="varchar(255)" />
            <column name="activation_status" type="integer" />
            <column name="additional_info" type="varchar(255)" />
            <column name="data_base64" type="text" />
            <column name="note" type="varchar(255)" />
            <column name="signature_type" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="signature" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_created" type="timestamp(6)">
                <constraints nullable="false" />
            </column>
            <column name="valid" type="boolean" />
            <column name="version" type="integer" defaultValue="2" />
            <column name="signature_version" type="varchar(255)" />
        </createTable>
    </changeSet>

    <changeSet id="15" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_integration"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_integration</comment>
        <createTable tableName="pa_integration">
            <column name="id" type="varchar(37)">
                <constraints primaryKey="true" />
            </column>
            <column name="name" type="varchar(255)" />
            <column name="client_token" type="varchar(37)">
                <constraints nullable="false" />
            </column>
            <column name="client_secret" type="varchar(37)">
                <constraints nullable="false" />
            </column>
        </createTable>
    </changeSet>

    <changeSet id="16" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_application_callback"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_application_callback</comment>
        <createTable tableName="pa_application_callback">
            <column name="id" type="varchar(37)">
                <constraints primaryKey="true" />
            </column>
            <column name="application_id" type="integer">
                <constraints nullable="false" foreignKeyName="callback_application_fk" referencedTableName="pa_application" referencedColumnNames="id" />
            </column>
            <column name="name" type="varchar(255)" />
            <column name="callback_url" type="varchar(1024)" />
            <column name="type" type="varchar(64)" defaultValue="ACTIVATION_STATUS_CHANGE">
                <constraints nullable="false" />
            </column>
            <column name="attributes" type="varchar(1024)" />
            <column name="authentication" type="text" />
        </createTable>
    </changeSet>

    <changeSet id="17" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_token"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_token</comment>
        <createTable tableName="pa_token">
            <column name="token_id" type="varchar(37)">
                <constraints primaryKey="true" />
            </column>
            <column name="token_secret" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="activation_id" type="varchar(37)">
                <constraints nullable="false" foreignKeyName="activation_token_fk" referencedTableName="pa_activation" referencedColumnNames="activation_id" />
            </column>
            <column name="signature_type" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_created" type="timestamp(6)">
                <constraints nullable="false" />
            </column>
        </createTable>
    </changeSet>

    <changeSet id="18" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_activation_history"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_activation_history</comment>
        <createTable tableName="pa_activation_history">
            <column name="id" type="bigint">
                <constraints primaryKey="true" />
            </column>
            <column name="activation_id" type="varchar(37)">
                <constraints nullable="false" foreignKeyName="history_activation_fk" referencedTableName="pa_activation" referencedColumnNames="activation_id" />
            </column>
            <column name="activation_status" type="integer" />
            <column name="event_reason" type="varchar(255)" />
            <column name="external_user_id" type="varchar(255)" />
            <column name="timestamp_created" type="timestamp(6)">
                <constraints nullable="false" />
            </column>
            <column name="activation_version" type="integer" />
        </createTable>
    </changeSet>

    <changeSet id="19" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_recovery_code"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_recovery_code</comment>
        <createTable tableName="pa_recovery_code">
            <column name="id" type="bigint">
                <constraints primaryKey="true" />
            </column>
            <column name="recovery_code" type="varchar(23)">
                <constraints nullable="false" />
            </column>
            <column name="application_id" type="integer">
                <constraints nullable="false" foreignKeyName="recovery_code_application_fk" referencedTableName="pa_application" referencedColumnNames="id" />
            </column>
            <column name="user_id" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="activation_id" type="varchar(37)">
                <constraints foreignKeyName="recovery_code_activation_fk" referencedTableName="pa_activation" referencedColumnNames="activation_id" />
            </column>
            <column name="status" type="integer">
                <constraints nullable="false" />
            </column>
            <column name="failed_attempts" type="integer" defaultValue="0">
                <constraints nullable="false" />
            </column>
            <column name="max_failed_attempts" type="integer" defaultValue="10">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_created" type="timestamp(6)">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_last_used" type="timestamp(6)" />
            <column name="timestamp_last_change" type="timestamp(6)" />
        </createTable>
    </changeSet>

    <changeSet id="20" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_recovery_puk"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_recovery_puk</comment>
        <createTable tableName="pa_recovery_puk">
            <column name="id" type="bigint">
                <constraints primaryKey="true" />
            </column>
            <column name="recovery_code_id" type="bigint">
                <constraints nullable="false" foreignKeyName="recovery_puk_code_fk" referencedTableName="pa_recovery_code" referencedColumnNames="id" />
            </column>
            <column name="puk" type="varchar(255)" />
            <column name="puk_encryption" type="integer" defaultValue="0">
                <constraints nullable="false" />
            </column>
            <column name="puk_index" type="bigint">
                <constraints nullable="false" />
            </column>
            <column name="status" type="integer">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_last_change" type="timestamp(6)" />
        </createTable>
    </changeSet>

    <changeSet id="21" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_recovery_config"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_recovery_config</comment>
        <createTable tableName="pa_recovery_config">
            <column name="id" type="integer">
                <constraints primaryKey="true" />
            </column>
            <column name="application_id" type="integer">
                <constraints nullable="false" foreignKeyName="recovery_config_app_fk" referencedTableName="pa_application" referencedColumnNames="id" />
            </column>
            <column name="activation_recovery_enabled" type="boolean" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
            <column name="recovery_postcard_enabled" type="boolean" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
            <column name="allow_multiple_recovery_codes" type="boolean" defaultValueBoolean="false">
                <constraints nullable="false" />
            </column>
            <column name="postcard_private_key_base64" type="varchar(255)" />
            <column name="postcard_public_key_base64" type="varchar(255)" />
            <column name="remote_public_key_base64" type="varchar(255)" />
            <column name="postcard_priv_key_encryption" type="integer" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
    </changeSet>

    <changeSet id="22" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_operation"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_operation</comment>
        <createTable tableName="pa_operation">
            <column name="id" type="varchar(37)">
                <constraints primaryKey="true" />
            </column>
            <column name="user_id" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="external_id" type="varchar(255)" />
            <column name="activation_flag" type="varchar(255)" />
            <column name="operation_type" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="template_name" type="varchar(255)" />
            <column name="data" type="text">
                <constraints nullable="false" />
            </column>
            <column name="parameters" type="text" />
            <column name="additional_data" type="text" />
            <column name="status" type="integer">
                <constraints nullable="false" />
            </column>
            <column name="signature_type" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="failure_count" type="bigint" defaultValue="0">
                <constraints nullable="false" />
            </column>
            <column name="max_failure_count" type="bigint">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_created" type="timestamp">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_expires" type="timestamp">
                <constraints nullable="false" />
            </column>
            <column name="timestamp_finalized" type="timestamp" />
            <column name="risk_flags" type="varchar(255)" />
        </createTable>
    </changeSet>

    <changeSet id="23" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_operation_template"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_operation_template</comment>
        <createTable tableName="pa_operation_template">
            <column name="id" type="bigint">
                <constraints primaryKey="true" />
            </column>
            <column name="template_name" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="operation_type" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="data_template" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="signature_type" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="max_failure_count" type="bigint">
                <constraints nullable="false" />
            </column>
            <column name="expiration" type="bigint">
                <constraints nullable="false" />
            </column>
            <column name="risk_flags" type="varchar(255)" />
        </createTable>
    </changeSet>

    <changeSet id="24" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pa_operation_application"/>
            </not>
        </preConditions>
        <comment>Create a new table pa_operation_application</comment>
        <createTable tableName="pa_operation_application">
            <column name="application_id" type="bigint">
                <constraints primaryKey="true" />
            </column>
            <column name="operation_id" type="varchar(37)">
                <constraints primaryKey="true" />
            </column>
        </createTable>
    </changeSet>

    <changeSet id="26" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_activation_application"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_activation(application_id)</comment>
        <createIndex tableName="pa_activation" indexName="pa_activation_application">
            <column name="application_id" />
        </createIndex>
    </changeSet>

    <changeSet id="27" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_activation_keypair"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_activation(master_keypair_id)</comment>
        <createIndex tableName="pa_activation" indexName="pa_activation_keypair">
            <column name="master_keypair_id" />
        </createIndex>
    </changeSet>

    <changeSet id="28" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_activation_code"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_activation(activation_code)</comment>
        <createIndex tableName="pa_activation" indexName="pa_activation_code">
            <column name="activation_code" />
        </createIndex>
    </changeSet>

    <changeSet id="29" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_activation_user_id"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_activation(user_id)</comment>
        <createIndex tableName="pa_activation" indexName="pa_activation_user_id">
            <column name="user_id" />
        </createIndex>
    </changeSet>

    <changeSet id="30" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_activation_expiration"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_activation(activation_status, timestamp_activation_expire)</comment>
        <createIndex tableName="pa_activation" indexName="pa_activation_expiration">
            <column name="activation_status" />
            <column name="timestamp_activation_expire" />
        </createIndex>
    </changeSet>

    <changeSet id="31" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_activation_history_act"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_activation_history(activation_id)</comment>
        <createIndex tableName="pa_activation_history" indexName="pa_activation_history_act">
            <column name="activation_id" />
        </createIndex>
    </changeSet>

    <changeSet id="32" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_activation_history_created"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_activation_history(timestamp_created)</comment>
        <createIndex tableName="pa_activation_history" indexName="pa_activation_history_created">
            <column name="timestamp_created" />
        </createIndex>
    </changeSet>

    <changeSet id="33" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_application_version_app"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_application_version(application_id)</comment>
        <createIndex tableName="pa_application_version" indexName="pa_application_version_app">
            <column name="application_id" />
        </createIndex>
    </changeSet>

    <changeSet id="34" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_master_keypair_application"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_master_keypair(application_id)</comment>
        <createIndex tableName="pa_master_keypair" indexName="pa_master_keypair_application">
            <column name="application_id" />
        </createIndex>
    </changeSet>

    <changeSet id="35" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_app_version_app_key"/>
            </not>
        </preConditions>
        <comment>Create a new unique index on pa_application_version(application_key)</comment>
        <createIndex tableName="pa_application_version" indexName="pa_app_version_app_key" unique="true">
            <column name="application_key" />
        </createIndex>
    </changeSet>

    <changeSet id="36" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_app_callback_app"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_application_callback(application_id)</comment>
        <createIndex tableName="pa_application_callback" indexName="pa_app_callback_app">
            <column name="application_id" />
        </createIndex>
    </changeSet>

    <changeSet id="37" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_integration_token"/>
            </not>
        </preConditions>
        <comment>Create a new unique index on pa_integration(client_token)</comment>
        <createIndex tableName="pa_integration" indexName="pa_integration_token" unique="true">
            <column name="client_token" />
        </createIndex>
    </changeSet>

    <changeSet id="38" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_signature_audit_activation"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_signature_audit(activation_id)</comment>
        <createIndex tableName="pa_signature_audit" indexName="pa_signature_audit_activation">
            <column name="activation_id" />
        </createIndex>
    </changeSet>

    <changeSet id="39" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_signature_audit_created"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_signature_audit(timestamp_created)</comment>
        <createIndex tableName="pa_signature_audit" indexName="pa_signature_audit_created">
            <column name="timestamp_created" />
        </createIndex>
    </changeSet>

    <changeSet id="40" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_token_activation"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_token(activation_id)</comment>
        <createIndex tableName="pa_token" indexName="pa_token_activation">
            <column name="activation_id" />
        </createIndex>
    </changeSet>

    <changeSet id="41" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_recovery_code_code"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_recovery_code(recovery_code)</comment>
        <createIndex tableName="pa_recovery_code" indexName="pa_recovery_code_code">
            <column name="recovery_code" />
        </createIndex>
    </changeSet>

    <changeSet id="42" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_recovery_code_app"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_recovery_code(application_id)</comment>
        <createIndex tableName="pa_recovery_code" indexName="pa_recovery_code_app">
            <column name="application_id" />
        </createIndex>
    </changeSet>

    <changeSet id="43" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_recovery_code_user"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_recovery_code(user_id)</comment>
        <createIndex tableName="pa_recovery_code" indexName="pa_recovery_code_user">
            <column name="user_id" />
        </createIndex>
    </changeSet>

    <changeSet id="44" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_recovery_code_act"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_recovery_code(activation_id)</comment>
        <createIndex tableName="pa_recovery_code" indexName="pa_recovery_code_act">
            <column name="activation_id" />
        </createIndex>
    </changeSet>

    <changeSet id="45" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_recovery_code_puk"/>
            </not>
        </preConditions>
        <comment>Create a new unique index on pa_recovery_puk(recovery_code_id, puk_index)</comment>
        <createIndex tableName="pa_recovery_puk" indexName="pa_recovery_code_puk" unique="true">
            <column name="recovery_code_id" />
            <column name="puk_index" />
        </createIndex>
    </changeSet>

    <changeSet id="46" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_recovery_puk_code"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_recovery_puk(recovery_code_id)</comment>
        <createIndex tableName="pa_recovery_puk" indexName="pa_recovery_puk_code">
            <column name="recovery_code_id" />
        </createIndex>
    </changeSet>

    <changeSet id="47" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_recovery_config_app"/>
            </not>
        </preConditions>
        <comment>Create a new unique index on pa_recovery_config(application_id)</comment>
        <createIndex tableName="pa_recovery_config" indexName="pa_recovery_config_app" unique="true">
            <column name="application_id" />
        </createIndex>
    </changeSet>

    <changeSet id="48" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_application_name"/>
            </not>
        </preConditions>
        <comment>Create a new unique index on pa_application(name)</comment>
        <createIndex tableName="pa_application" indexName="pa_application_name" unique="true">
            <column name="name" />
        </createIndex>
    </changeSet>

    <changeSet id="49" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_operation_user"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_operation(user_id)</comment>
        <createIndex tableName="pa_operation" indexName="pa_operation_user">
            <column name="user_id" />
        </createIndex>
    </changeSet>

    <changeSet id="50" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_operation_ts_created_idx"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_operation(timestamp_created)</comment>
        <createIndex tableName="pa_operation" indexName="pa_operation_ts_created_idx">
            <column name="timestamp_created" />
        </createIndex>
    </changeSet>

    <changeSet id="51" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_operation_ts_expires_idx"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_operation(timestamp_expires)</comment>
        <createIndex tableName="pa_operation" indexName="pa_operation_ts_expires_idx">
            <column name="timestamp_expires" />
        </createIndex>
    </changeSet>

    <changeSet id="52" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_operation_status_exp"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_operation(timestamp_expires, status)</comment>
        <createIndex tableName="pa_operation" indexName="pa_operation_status_exp">
            <column name="timestamp_expires" />
            <column name="status" />
        </createIndex>
    </changeSet>

    <changeSet id="53" logicalFilePath="powerauth-java-server/1.4.x/20230322-init-db.xml" author="Lubos Racansky">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="pa_operation_template_name_idx"/>
            </not>
        </preConditions>
        <comment>Create a new index on pa_operation_template(template_name)</comment>
        <createIndex tableName="pa_operation_template" indexName="pa_operation_template_name_idx">
            <column name="template_name" />
        </createIndex>
    </changeSet>

</databaseChangeLog>
